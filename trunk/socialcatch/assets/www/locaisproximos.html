<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>Locais próximos</title>
<link rel="stylesheet" type="text/css"
	href="lib/resources/css/sencha-touch.css" />
<script type="text/javascript" src="lib/sencha-touch.js"></script>


</head>

<body>

	<script type="text/javascript">
	
	//Localização!!
	

  

    // onSuccess Geolocation
    //
    function onSuccess(position) {
    	
    	alert('Latitude:'+position.coords.latitude+' Longitude:'+  position.coords.longitude);
      
    	Ext.util.JSONP.request({
			url : 'http://dl.dropbox.com/u/1301044/JSON/test.json',
			callbackkey: 'callback',
			callback: function(data){
				var nomelist = data.places;
				placesproximos.update(nomelist);
				
			}
		});
		
    }

    // onError Callback receives a PositionError object
    //
    function onError(error) {
        alert('code: '    + error.code    + '\n' +
              'message: ' + error.message + '\n');
    }

    
    
		function clickListItem(id) {

			if (id == "sandro") {
				alert(id + "aaaaa");
			} else {
				alert(id);
			}

		}

		Ext.setup({

					onReady : function() {
						
						//Registar o callback para quando tiver a localização...
						navigator.geolocation.getCurrentPosition(onSuccess, onError);
						
						
						var panel;
						placesproximos = new Ext.Component(
								{
									title : "Places Próximos",
									scroll : 'vertical',
									tpl : [
											'<tpl for=".">',
											'<h2 id={id} onClick="clickListItem(id)">{id}</h2>',
											'</tpl>' ]
								});

						placespornome = {
							title : "Procurar Place",
							html : "nada...."
						}

						var buttonsSpecTop = [ {
							ui : 'back',
							text : 'Back'
						}, {
							xtype : 'spacer'
						}, {
							ui : 'forward',
							text : 'Forward'
						} ]

						var buttonsSpecBottom = [ {
							ui : 'normal',
							text : 'Normal'
						}, {
							ui : 'round',
							text : 'Round'
						}, {
							ui : 'action',
							text : 'Action'
						}, {
							ui : 'confirm',
							text : 'Confirm'
						} ]

						var tapHandler = function(btn, evt) {
							alert("Button '" + btn.text + "' tapped.");
						}

						var dockedItems = [ {
							xtype : 'toolbar',
							ui : 'dark',
							dock : 'bottom',
							items : buttonsSpecBottom,
							defaults : {
								handler : tapHandler
							}
						} ]

						panel = new Ext.TabPanel({
							fullscreen : true,
							animation : 'slide',
							items : [ placesproximos, placespornome ],
							dockedItems : dockedItems

						});

					
						
					
						
						
					}
				});
		
		
		
		

	    
	</script>



</body>

</html>
